apiVersion: v1
kind: Config
clusters:
- cluster:
    server: EKS_CLUSTER_ENDPOINT
    certificate-authority-data: EKS_CLUSTER_CA
  name: eks_cluster
contexts:
- context:
    cluster: eks_cluster
    user: eks_user
  name: eks_context
current-context: eks_context
users:
- name: eks_user
  user:
    exec:
      apiVersion: client.authentication.k8s.io/v1alpha1
      command: aws
      args:
      - "eks"
      - "get-token"
      - "--cluster-name"
      - "EKS_CLUSTER_NAME"
      # Set the AWS_PROFILE or use environment variables
      env:
      - name: AWS_PROFILE
        value: "aws_profile_name"
